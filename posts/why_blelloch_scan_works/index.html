<!doctype html><html lang=en><head><title>Why Blelloch Scan Works :: Dhruv Patel</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A video blog explaining why Blelloch scan works"><meta name=keywords content="prefix sum,parallel algorithm,cuda"><meta name=robots content="noodp"><link rel=canonical href=https://dhruvpatel.dev/posts/why_blelloch_scan_works/><link rel=stylesheet href=https://dhruvpatel.dev/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://dhruvpatel.dev/css/code.min.4f0ccc8439f99bf7f7970298556b94011aabc1fcae743b6842fc3361a2da9ea3.css><link rel=stylesheet href=https://dhruvpatel.dev/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://dhruvpatel.dev/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://dhruvpatel.dev/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://dhruvpatel.dev/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://dhruvpatel.dev/css/main.min.15870410d15d02abd22fb5ef00996f65a00d04b3a7435e9f83831c7c2298de88.css><link rel=stylesheet href=https://dhruvpatel.dev/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://dhruvpatel.dev/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://dhruvpatel.dev/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://dhruvpatel.dev/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://dhruvpatel.dev/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://dhruvpatel.dev/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel="shortcut icon" href=https://dhruvpatel.dev/favicon.png><link rel=apple-touch-icon href=https://dhruvpatel.dev/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Why Blelloch Scan Works"><meta property="og:description" content="A video blog explaining why Blelloch scan works"><meta property="og:url" content="https://dhruvpatel.dev/posts/why_blelloch_scan_works/"><meta property="og:site_name" content="Dhruv Patel"><meta property="og:image" content="https://dhruvpatel.dev/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2021-10-02 09:31:44 +0530 +0530"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Dhruv Patel</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;â–¾</li><li><ul class=menu__dropdown><li><a href=/about/>About</a></li><li><a href=https://github.com/DhruvPatel01/>Github</a></li><li><a href=/notes>Notes</a></li><li><a href=/now>Now</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about/>About</a></li><li><a href=https://github.com/DhruvPatel01/>Github</a></li><li><a href=/notes>Notes</a></li><li><a href=/now>Now</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://dhruvpatel.dev/posts/why_blelloch_scan_works/>Why Blelloch Scan Works</a></h1><div class=post-meta><time class=post-date>2021-10-02</time></div><span class=post-tags>#<a href=https://dhruvpatel.dev/tags/parallel-computing/>parallel-computing</a>&nbsp;
#<a href=https://dhruvpatel.dev/tags/cuda/>cuda</a>&nbsp;</span><div class=post-content><div><p>Blelloch scan is a (exclusive) scan algorithm for parallel computers. A common example of scan is prefix sum.</p><details class=collapsable-code><summary title="Click to interact"><span class=collapsable-code__title>sequential.py</span></summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>exclusive_scan</span>(a, op):
</span></span><span style=display:flex><span>    b <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>] <span style=color:#75715e># Identity of the op, (for sum and max, it is 0).</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> a[:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]:
</span></span><span style=display:flex><span>        b<span style=color:#f92672>.</span>append(op(x, b[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> b
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exclusive_scan([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>], <span style=color:#66d9ef>lambda</span> x, y: x<span style=color:#f92672>+</span>y) <span style=color:#f92672>==</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>6</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exclusive_scan([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>], max) <span style=color:#f92672>==</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>]</span></span></code></pre></div></details><p>This vlog is complementary to the excellent <a href=https://youtu.be/mmYv3Haj6uc>video description</a> from now archived Udacity CS344 course. The video explains the &ldquo;how&rdquo; of the algorithm very well, but I couldn&rsquo;t easily find &ldquo;why&rdquo; of the algorithm, neither in that video nor in any other videos on the Internet. So here is my attempt to explain it.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/04QXOwzdIOg?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h></span><hr></div><div class=pagination__buttons><a href=https://dhruvpatel.dev/posts/aoc/21/day7/ class="button inline prev">&lt; [<span class=button__text>Why the solution to part 2(AoC21-Day7) works?</span>]
</a>::
<a href=https://dhruvpatel.dev/posts/python_circular_imports/ class="button inline next">[<span class=button__text>Python got me with circular imports!</span>] ></a></div></div></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Dhruv Patel</span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>