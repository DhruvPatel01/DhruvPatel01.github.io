<!doctype html><html lang=en><head><title>Why Blelloch Scan Works :: Dhruv Patel</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A video blog explaining why Blelloch scan works"><meta name=keywords content="prefix sum,parallel algorithm,cuda"><meta name=robots content="noodp"><link rel=canonical href=https://dhruvpatel.dev/posts/why_blelloch_scan_works/><link rel=stylesheet href=https://dhruvpatel.dev/assets/style.css><link rel=apple-touch-icon href=https://dhruvpatel.dev/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://dhruvpatel.dev/img/favicon/orange.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Why Blelloch Scan Works"><meta property="og:description" content="A video blog explaining why Blelloch scan works"><meta property="og:url" content="https://dhruvpatel.dev/posts/why_blelloch_scan_works/"><meta property="og:site_name" content="Dhruv Patel"><meta property="og:image" content="https://dhruvpatel.dev"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-10-02 09:31:44 +0530 +0530"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body class=orange><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Dhruv Patel</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about/>About</a></li><li><a href=https://github.com/DhruvPatel01/>Github</a></li><li><a href=/notes>Notes</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about/>About</a></li><li><a href=https://github.com/DhruvPatel01/>Github</a></li><li><a href=/notes>Notes</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://dhruvpatel.dev/posts/why_blelloch_scan_works/>Why Blelloch Scan Works</a></h1><div class=post-meta><span class=post-date>2021-10-02</span></div><span class=post-tags>#<a href=https://dhruvpatel.dev/tags/parallel-computing/>parallel-computing</a>&nbsp;
#<a href=https://dhruvpatel.dev/tags/cuda/>cuda</a>&nbsp;</span><div class=post-content><div><p>Blelloch scan is a (exclusive) scan algorithm for parallel computers. A common example of scan is prefix sum.</p><div class=collapsable-code><input id=169428735 type=checkbox>
<label for=169428735><span class=collapsable-code__language>python</span>
<span class=collapsable-code__title>sequential.py</span>
<span class=collapsable-code__toggle data-label-expand=△ data-label-collapse=▽></span></label><pre class=language-python><code>

def exclusive_scan(a, op):
    b = [0] # Identity of the op, (for sum and max, it is 0).
    for x in a[:-1]:
        b.append(op(x, b[-1]))
    return b

exclusive_scan([1, 2, 3, 4], lambda x, y: x&#43;y) == [0, 1, 3, 6]

exclusive_scan([1, 2, 3, 4], max) == [0, 1, 2, 3]


</code></pre></div><p>This vlog is complementary to the excellent <a href=https://youtu.be/mmYv3Haj6uc>video description</a> from now archived Udacity CS344 course. The video explains the &ldquo;how&rdquo; of the algorithm very well, but I couldn&rsquo;t easily find &ldquo;why&rdquo; of the algorithm, neither in that video nor in any other videos on the Internet. So here is my attempt to explain it.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/04QXOwzdIOg style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://dhruvpatel.dev/posts/aoc/21/day7/><span class=button__icon>←</span>
<span class=button__text>Why the solution to part 2(AoC21-Day7) works?</span></a></span>
<span class="button next"><a href=https://dhruvpatel.dev/posts/python_circular_imports/><span class=button__text>Python got me with circular imports!</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Dhruv Patel</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://dhruvpatel.dev/assets/main.js></script>
<script src=https://dhruvpatel.dev/assets/prism.js></script></div></body></html>